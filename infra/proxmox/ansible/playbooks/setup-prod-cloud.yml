---
# Configure production cloud server
# Usage: ansible-playbook playbooks/setup-prod-cloud.yml
# With Tailscale: ansible-playbook playbooks/setup-prod-cloud.yml --extra-vars "tailscale_auth_key=YOUR_KEY"

- name: Configure Production Cloud Server
  hosts: prod_cloud
  become: true

  roles:
    - common
    - docker
    - nodejs
    - cloud-app
    - backups
    - tailscale

  post_tasks:
    - name: Display prod cloud setup summary
      ansible.builtin.debug:
        msg:
          - "Production Cloud Server Configuration Complete"
          - "Environment: {{ environment }}"
          - "Application Base: {{ app_base_dir }}"
          - "MongoDB Data: {{ mongodb_data_dir }}"
          - "Deploy applications via GitHub Actions workflow"
          - "âœ… Automated backups configured (MongoDB dumps + retention)"
          - "Tailscale hostname: {{ tailscale_hostname }}"
          - "Tailscale Funnel enabled: {{ tailscale_funnel_enabled }}"
